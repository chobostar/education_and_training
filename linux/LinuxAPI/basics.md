# Основные понятия

Задачи, выполняемые ядром:
- Диспетчеризация процессов. Несколько процессов (например, запущенные программы) могут одновременно находиться в памяти и каждая может получить в свое распоряжение центральный процессор (процессоры).
- Управление памятью.
  - Процессы изолированы друг от друга и от ядра, поэтому один процесс не может читать или изменять содержимое памяти другого процесса или ядра.
  - В памяти требуется хранить только часть процесса, снижая таким образом объем памяти, требуемый каждому процессу и позволяя одновременно содержать в оперативной памяти большее количество процессов.
 - Предоставление файловой системы.
 - Создание и завершение процессов. Как только выполнение процесса завершится, ядро обеспечивает высвобождение используемых им ресурсов
 - Доступ к устройствам.
 - Работа в сети. Ядро от имени пользовательских процессов отправляет и принимает сетевые сообщения (пакеты).
 - Предоставление API системных вызовов.

Linux - абстракция виртуального персонального компьютера для каждого пользователя.

### Файловый дескриптор

Системные вызовы ввода-вывода ссылаются на открытый файл с использованием файлового дескриптора, 
представляющего собой неотрицательное (обычно небольшое) целое число. Файловый дескриптор обычно возвращается из выдачи системного вызова open(),
который получает в качестве аргумента путевое имя, а оно, в свою очередь, указывает на файл, в отношении которого будут выполняться операции ввода-вывода.

При запуске оболочкой процесс наследует 3 декскриптора:
- дескриптор 0 является стандартным вводом — файлом, из которого процесс получает свой ввод;
- дескриптор 1 является стандартным выводом — файлом, в который процесс записывает свой вывод;
- дескриптор 2, являющийся стандартной ошибкой, — файлом, в который процесс записывает сообщения об ошибках и уведомления об исключительных и нештатныхусловиях.

В библиотеке stdio они соответствуют файловым потокам stdin, stdout и stderr.

### Модель памяти процесса
Процесс логически делится на следующие части, известные как сегменты.
- Текст — инструкции программы.
- Данные — статические переменные, используемые программой.
- Динамическая память (куча) — область, из которой программа может динамически выделять дополнительную память.
- Стек — часть памяти, которая может расширяться и сжиматься по мере вызова функций и возвращения из них и которая используется для выделения хранилища под локальные переменные и информацию о взаимосвязанности вызовов функций.

### Ограничение ресурсов
Используя системный вызов setrlimit(), процесс может установить верхний предел своего потребления различных ресурсов.

Когда с помощью fork() создается новый процесс, он наследует копии настроек ограничений ресурсов от своего родительского процесса.

Ограничения ресурсов оболочки могут быть отрегулированы с использованием команды ulimit

### Отображение в памяти
Системный вызов mmap() создает в виртуальном адресном пространстве вызывающего процесса новое отображение в памяти.
Отображения делятся на две категории.
- Файловое отображение, которое отображает область файла на виртуальную память вызывающего процесса. После отображения содержимое файла может быть доступно с помощью операций над байтами в соответствующей области памяти. Страницы отображения автоматически загружаются из файла по мере надобности.
- В противоположность первой категории, анонимное отображение не имеет соответствующего файла. Вместо этого страницы отображения получают начальное значение 0.

Отображения в памяти служат для различных целей:
- инициализацию текстового сегмента процесса из соответствующего сегмента выполняемого файла
- выделения новой (заполненной нулями) памяти
- файлового ввода-вывода (ввода-вывода с отображением в памяти)
- обмена данными между процессами (через общее отображение в памяти)

### IPC
IPC:
- сигналы, которые используются в качестве признака возникновения события;
- конвейеры (известные пользователям оболочек в виде оператора |) и FIFO-буферы, которые могут применяться для передачи данных между процессами;
- сокеты, которые могут использоваться для передачи данных от одного процесса к другому; данные при этом находятся на одном и том же базовом компьютере либо на различных хостах, связанных по сети;
- файловая блокировка, позволяющая процессу блокировать области файла с целью предотвращения их чтения или обновления содержимого файла другими процессами;
- очереди сообщений, которые используются для обмена сообщениями (пакетами данных) между процессами;
- семафоры, которые применяются для синхронизации действий процессов;
- совместно используемая память, позволяющая двум и более процессам совместно использовать часть памяти. Когда один процесс изменяет содержимое совместно используемой области памяти, изменения тут же могут быть видимы всем остальным процессам.

### Сигналы
Когда процесс получает сигнал, он:
- игнорирует сигнал;
- прекращает свою работу по сигналу;
  приостанавливается, чтобы впоследствии возобновить свое выполнение с получением сигнала специального назначения.

### Дата и время
Для процесса интерес представляют два типа времени:
- Реальное время, которое измеряется либо относительно некоторой стандартной точки
  (календарного времени), либо относительно какой-то фиксированной точки, обычно
  от начала жизненного цикла процесса (истекшее или физическое время).
-  Время процесса, также называемое временем центрального процессора, которое явля-
   ется общим количеством времени центрального процессора, использованным про-
   цессом с момента старта. Время ЦП далее делится на системное время центрального
   процессора, то есть время, потраченное на выполнение кода в режиме ядра (например,
   на выполнение системных вызовов и работу других служб ядра от имени процесса),
   и пользовательское время центрального процессора, потраченное на выполнение кода
   в пользовательском режиме (например, на выполнение обычного программного кода).